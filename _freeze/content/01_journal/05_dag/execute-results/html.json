{
  "hash": "e64bfe2975f008535201989adb3692b5",
  "result": {
    "markdown": "---\ntitle: \"Directed Acyclic Graphs\"\n---\n\n# Assignment 5\n\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-1_371214972eaccaab4403b32ff76aefcd'}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(dagitty)\nlibrary(ggdag)\nlibrary(tidyverse)\n```\n:::\n\n## Assignment 5.1\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-2_5ff3f601cb0d23e4da472c2cb1df3558'}\n\n```{.r .cell-code}\n# Define the DAG for the parking spot example\nparking_dag <- dagify(\n  sales ~ parking_spots,\n  sales ~ location,\n  parking_spots ~ location,\n  coords = list(x = c(sales = 1, parking_spots = 3, location = 2),\n                y = c(sales = 0, parking_spots = 0, location = 1))\n)\n\n\n# Plot the DAG with default ggplot2 theme\nggdag(parking_dag, text = FALSE) +\n  geom_dag_point() +\n  geom_dag_text(color = \"red\") +\n  geom_dag_edges(edge_color = \"black\")\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n## Assignment 5.2.1\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-3_68a1b17a986f7bf1233cbcd236c744de'}\n\n```{.r .cell-code}\n# Load the data file customer_sat.rds\ndata <- readRDS(\"data/customer_sat.rds\")\n\n# 1. Regress satisfaction on follow_ups\nmodel_1 <- lm(satisfaction ~ follow_ups, data = data)\n\nsummary(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ follow_ups, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -12.412  -5.257   1.733   4.506  12.588 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  78.8860     4.2717  18.467 1.04e-10 ***\n#> follow_ups   -3.3093     0.6618  -5.001 0.000243 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 7.923 on 13 degrees of freedom\n#> Multiple R-squared:  0.658,\tAdjusted R-squared:  0.6316 \n#> F-statistic: 25.01 on 1 and 13 DF,  p-value: 0.0002427\n```\n:::\n:::\n\n## Assignment 5.2.2\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-4_a161ca5a04ae52b80bef6429812e2173'}\n\n```{.r .cell-code}\n# 2. Regress satisfaction on follow_ups and account for subscription\nmodel_2 <- lm(satisfaction ~ follow_ups + subscription, data = data)\n\nsummary(model_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ follow_ups + subscription, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -4.3222 -2.1972  0.3167  2.2667  3.9944 \n#> \n#> Coefficients:\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)           26.7667     6.6804   4.007  0.00206 ** \n#> follow_ups             2.1944     0.7795   2.815  0.01682 *  \n#> subscriptionPremium   44.7222     5.6213   7.956 6.88e-06 ***\n#> subscriptionPremium+  18.0722     2.1659   8.344 4.37e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2.958 on 11 degrees of freedom\n#> Multiple R-squared:  0.9597,\tAdjusted R-squared:  0.9487 \n#> F-statistic: 87.21 on 3 and 11 DF,  p-value: 5.956e-08\n```\n:::\n:::\n\n## Assignment 5.3\nAccording to the first regression, there is a negative relationship between follow_ups and satisfaction, indicating that as the number of follow-up calls increases, so does satisfaction.\n\nThe second regression, which takes into account both follow_ups and subscription levels, reveals that, while follow_ups continue to have an impact on satisfaction, subscription levels (Premium and Premium+) also have a significant impact. Furthermore, the subscription level coefficients imply that higher subscription tiers (Premium and Premium+) have a positive impact on satisfaction when compared to some assumed base level (possibly Starter, which is not explicitly included as a variable).\n\n## Assignment 5.4\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-5_cd7ce36abc50d67b626f90ff7fe79f26'}\n\n```{.r .cell-code}\n# Create a DAG for the relationship between follow-up calls, satisfaction, and subscription\nsaas_dag <- dagify(\n  satisfaction ~ follow_ups,\n  satisfaction ~ subscription,\n  follow_ups ~ subscription,\n  coords = list(x = c(satisfaction = 1, follow_ups = 3, subscription = 2),\n                y = c(satisfaction = 0, follow_ups = 0, subscription = 1))\n)\n\n# Plot the DAG \nggdag(saas_dag, text = FALSE) +\n  geom_dag_point() +\n  geom_dag_text(color = \"red\") +\n  geom_dag_edges(edge_color = \"black\")\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}